<idea-plugin>
    <id>org.amdatu.ide</id>
    <name>Amdatu IDE</name>
    <version>1.0.0</version>
    <description></description>
    <category></category>
    <vendor>Amdatu</vendor>
    <idea-version since-build="163.0"/>

    <change-notes>

    </change-notes>

    <depends>com.intellij.modules.java</depends>

    <project-components>
        <component>
            <interface-class>org.amdatu.ide.AmdatuIdePlugin</interface-class>
            <implementation-class>org.amdatu.ide.AmdatuIdePluginImpl</implementation-class>
        </component>
    </project-components>


    <extensionPoints>
        <extensionPoint name="lang.bundledescriptor.parser.provider" interface="org.amdatu.ide.lang.bundledescriptor.header.HeaderParserProvider"/>
    </extensionPoints>



    <extensions defaultExtensionNs="com.intellij">
        <!-- Initialize AmdatuIde plugin -->
        <postStartupActivity implementation="org.amdatu.ide.AmdatuIdePluginStartup"/>

        <!-- Project import -->
        <projectImportProvider implementation="org.amdatu.ide.imp.BndProjectImportProvider"/>

        <!-- Inspections -->
        <inspectionToolProvider implementation="org.amdatu.ide.inspections.AmdatuIdeInspectionToolProvider"/>

        <!-- Language -->
        <fileTypeFactory implementation="org.amdatu.ide.lang.bundledescriptor.BundleDescriptorTypeFactory"/>
        <lang.parserDefinition language="BundleDescriptor" implementationClass="org.amdatu.ide.lang.bundledescriptor.parser.BundleDescriptorParserDefinition"/>
        <lang.syntaxHighlighterFactory language="BundleDescriptor" implementationClass="org.amdatu.ide.lang.bundledescriptor.highlighting.BundleDescriptorSyntaxHighlighterFactory"/>
        <annotator language="BundleDescriptor" implementationClass="org.amdatu.ide.lang.bundledescriptor.highlighting.HeaderAnnotator"/>
        <lang.elementManipulator forClass="org.amdatu.ide.lang.bundledescriptor.psi.HeaderValuePart"
                                 implementationClass="org.amdatu.ide.lang.bundledescriptor.psi.impl.HeaderValuePartManipulator"/>
        <completion.contributor language="BundleDescriptor" implementationClass="org.amdatu.ide.lang.bundledescriptor.completion.BundleDescriptorCompletionContributor"/>
        <completion.contributor language="BundleDescriptor" implementationClass="org.amdatu.ide.lang.bundledescriptor.completion.BlueprintFeatureCompletionContributor"/>
        <completion.contributor language="BundleDescriptor" implementationClass="org.amdatu.ide.lang.bundledescriptor.completion.BsnCompletionContributor"/>
        <completion.contributor language="BundleDescriptor" implementationClass="org.amdatu.ide.lang.bundledescriptor.completion.PackageCompletionContributor"/>

        <applicationService serviceImplementation="org.amdatu.ide.lang.bundledescriptor.header.HeaderParserRepository"/>


        <!-- JPS plugin -->
        <compileServer.plugin classpath="jps-plugin.jar;biz.aQute.bnd-3.5.0.jar"/>

        <!--  Run -->
        <configurationType implementation="org.amdatu.ide.run.BndRunConfigurationType"/>
        <runConfigurationProducer implementation="org.amdatu.ide.run.BndRunConfigurationProducer$Launch"/>
        <runConfigurationProducer implementation="org.amdatu.ide.run.BndRunConfigurationProducer$Test"/>

        <!-- Custom module type supporting bndtools templates-->
        <!--<projectTemplatesFactory implementation="org.amdatu.ide.templating.BndtoolsProjectTemplatesFactory"></projectTemplatesFactory>-->
        <moduleType id="AMDATU_IDE_MODULE_TYPE" implementationClass="org.amdatu.ide.templating.AmdatuIdeModuleType"/>

        <toolWindow id="Amdatu IDE " icon="OsmorcIdeaIcons.Bnd" anchor="right" factoryClass="org.amdatu.ide.toolwindow.AmdatuIdeToolWindowFactory"/>

        <!-- Plugin preferences -->
        <applicationService serviceImplementation="org.amdatu.ide.preferences.AmdatuIdePreferences"/>
        <applicationConfigurable groupId="language" id="amdatu.ide.preferences" displayName="Amdatu IDE"
                                 instance="org.amdatu.ide.preferences.AmdatuIdePreferencesEditor"/>

    </extensions>

    <extensions defaultExtensionNs="org.amdatu.ide">
        <lang.bundledescriptor.parser.provider implementation="org.amdatu.ide.lang.bundledescriptor.header.impl.StandardManifestHeaderParsers"/>
        <lang.bundledescriptor.parser.provider implementation="org.amdatu.ide.lang.bundledescriptor.header.impl.BndHeaderParsers"/>
        <lang.bundledescriptor.parser.provider implementation="org.amdatu.ide.lang.bundledescriptor.header.impl.AmdatuBlueprintHeaderParsers"/>
    </extensions>


    <actions>
        <group popup="true" text="Amdatu IDE" id="AmdatuIDE" description="Amdatu IDE">
            <add-to-group group-id="ToolsMenu" anchor="last"/>
        </group>
        <!-- Project re-import (manual) -->
        <action id="amdatu.ide.action.reimport.workspace" icon="OsmorcIdeaIcons.Bnd" text="Reimport Workspace"
                description="Reimport entire Bnd/Bndtools workspace"
                class="org.amdatu.ide.imp.ReimportWorkspaceAction">
            <add-to-group group-id="AmdatuIDE" anchor="last"/>

        </action>

        <!-- Refresh workspace -->
        <action id="amdatu.ide.action.refresh-workspace" icon="OsmorcIdeaIcons.Bnd"
                text="Refresh workspace"
                description="Refresh workspace"
                class="org.amdatu.ide.actions.RefreshWorkspaceAction">
            <add-to-group group-id="AmdatuIDE" anchor="last"/>
        </action>

        <!-- Generate index -->
        <action id="amdatu.ide.action.generate-index" icon="OsmorcIdeaIcons.Bnd"
                text="Generate index"
                description="Generate index"
                class="org.amdatu.ide.actions.index.GenerateIndexAction">
            <add-to-group group-id="AmdatuIDE" anchor="last"/>
            <add-to-group group-id="ProjectViewPopupMenu" anchor="last"/>
        </action>
    </actions>
</idea-plugin>
